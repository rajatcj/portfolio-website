<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://kit.fontawesome.com/19746ffdef.js" crossorigin="anonymous"></script>
  

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.min.css'>
<link rel="stylesheet" href="./style.css">


</head>
<body>
  <div class="loading-screen">
    <div class="loading">
        <div class="rotate">L</div>OADING
      </div>
  </div>
<div class="chat">
  <div class="chat-title">
    <div id="status"></div>
    <h1>Rajat Jha</h1>
    <h2>#Website-messages</h2>
    <figure class="avatar">
      <img src="https://dcdn.dstn.to/avatars/754033245972201612" /></figure>
  </div>
  <div class="messages">
    <div id="messages-content" class="messages-content mCustomScrollbar _mCS_2">
           <div id="msgbox"></div>
    </div>
  </div>
</div>
<div class="bg"></div>

    <!--lanyard-->
    <script src="../profile/assets/javascripts/lanyard.js"></script>

    <!--J query-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>

<!-- partial -->
<script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.concat.min.js'></script>

<!----<script  src="./script.js"></script>-->

<script>

  // theme
// parse the query string
let params = new URLSearchParams(window.location.search);

// check if the theme parameter is present in the query string
if (params.has('theme')) {
  // if it is, use the value of the theme parameter as the theme
  let theme = params.get('theme');
  document.documentElement.setAttribute('data-theme', theme);
} else {
  // if it is not, use the value from local storage
  let currentTheme = localStorage.getItem('theme');
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);
  }
}

  


</script>

<script>
var chatid = localStorage.getItem("chatid");
// loadchatonupdate
updatechat("true");
  
lanyard({
    userId: "754033245972201612",
    socket: true,
    onPresenceUpdate: updatechat
})


function updatechat(scrolldown) {
  var $messages = $('.messages-content');
  var messageslist = '<div class="message new" style="border-radius: 0px 0px 0px 0px;">Wanna See More Messages? Join Our Discord Server <a href="https://discord.gg/NYsDNf2AcK">here</a> and see the channel <b>#website-messages</b>.</div>';
  fetch("https://api.lanyard.rest/v1/users/754033245972201612")
            .then(response => response.json())
            .then(data => {
              const dataArray = JSON.parse(data.data.kv.chatdata)


              const chatid = 'your-id';

const msgbox = document.querySelector('.msgbox');

const introElement = document.createElement('div');
introElement.classList.add('message', 'new');
introElement.style.borderRadius = '0px 0px 0px 0px';
introElement.innerHTML = 'Wanna See More Messages? Join Our Discord Server <a href="https://discord.gg/NYsDNf2AcK">here</a> and see the channel <b>#website-messages</b>.';
msgbox.appendChild(introElement);
console.log[dataArray[0]]
for (var i = 0; i < dataArray.length; i++) {
  let messageElement;
  if (dataArray[i].id === youyou) {
    messageElement = document.createElement('div');
    messageElement.classList.add('message', 'message-personal');
  } else {
    messageElement = document.createElement('div');
    messageElement.classList.add('message', 'new');
    if (dataArray[i].id === 'mememe') {
      messageElement.style.background = 'var(--my-message)';
    }
  }

  if (dataArray[i].id !== youyou) {
    const avatarElement = document.createElement('figure');
    avatarElement.classList.add('avatar');
    const avatarImg = document.createElement('img');
    avatarImg.src = `https://avatars.dicebear.com/api/avataaars/${dataArray[i].id}.png?b=%2343192d`;
    avatarElement.appendChild(avatarImg);
    messageElement.appendChild(avatarElement);
  }

  if (dataArray[i].reid) {
    const repliedToElement = document.createElement('div');
    repliedToElement.classList.add('repliedtomsg');
    const repliedToImg = document.createElement('img');
    repliedToImg.classList.add('repliedtoavatar');
    repliedToImg.src = `https://avatars.dicebear.com/api/avataaars/${dataArray[i].reid}.png?b=%2343192d`;
    repliedToElement.appendChild(repliedToImg);
    repliedToElement.innerHTML += dataArray[i].reco;
    messageElement.appendChild(repliedToElement);
  }

  messageElement.innerHTML += `${dataArray[i].co}`;
  console.log(messageElement)
  msgbox.appendChild(messageElement);
};

const outroElement = document.createElement('div');
outroElement.classList.add('message', 'message-personal');
const outroAvatarElement = document.createElement('figure');
outroAvatarElement.classList.add('avatar');
const outroAvatarImg = document.createElement('img');
outroAvatarImg.src = `https://avatars.dicebear.com/api/avataaars/${chatid}.png?b=%2343192d`;
outroAvatarElement.appendChild(outroAvatarImg);
outroElement.appendChild(outroAvatarElement);

document.getElementById("msgbox").innerHTML=outroElement;







              var chatroom = document.getElementById('messages-content');

              if (scrolldown === "true") {
                setTimeout(()=> {
                $messages.mCustomScrollbar("update").mCustomScrollbar('scrollTo', 'bottom', {
                  scrollInertia: 10,
                  timeout: 0
                });
                
          document.querySelector(".loading-screen").style.display = "none";
              }
      ,2000);
              } else {
              if (chatroom.scrollTop < chatroom.scrollHeight - chatroom.clientHeight) {
                // If the user has scrolled up, do not update the scroll position
                $messages.mCustomScrollbar("update").mCustomScrollbar('scrollTo', 'bottom', {
                  scrollInertia: 10,
                  timeout: 0
                });
              }
            }
            document.getElementById("status").innerHTML=`<span style="color:` + (data.data.discord_status === `online` ? `#3ba55d` : (data.data.discord_status === `idle` ? `#faa81a` : (data.data.discord_status === `dnd` ? `#ED4245` : `#747f8d` )) ) + `;">` + (data.data.discord_status === `online` ? `Online ` : (data.data.discord_status === `idle` ? `Idle ` : (data.data.discord_status === `dnd` ? `DND ` : `Offline ` )) ) + `<i class="fa-solid fa-circle-dot"></i></span>`;
            
                
            });
};



</script>

       <!-- Add a script to handle the loading screen -->

      
</body>
</html>


