<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://kit.fontawesome.com/19746ffdef.js" crossorigin="anonymous"></script>
  

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.min.css'>
<link rel="stylesheet" href="./style.css">


</head>
<body>

<div class="chat">
  <div class="chat-title">
    <div id="status"></div>
    <h1>Rajat Jha</h1>
    <h2>#Website-messages</h2>
    <figure class="avatar">
      <img src="https://dcdn.dstn.to/avatars/754033245972201612" /></figure>
  </div>
  <div class="messages">
    <div id="messages-content" class="messages-content mCustomScrollbar _mCS_2">
           <div id="msgbox"></div>
    </div>
  </div>
</div>
<div class="bg"></div>

    <!--lanyard-->
    <script src="../profile/assets/javascripts/lanyard.js"></script>

    <!--J query-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"> </script>

<!-- partial -->
<script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.concat.min.js'></script>

<!----<script  src="./script.js"></script>-->

<script>
  // theme
// parse the query string
let params = new URLSearchParams(window.location.search);

// check if the theme parameter is present in the query string
if (params.has('theme')) {
  // if it is, use the value of the theme parameter as the theme
  let theme = params.get('theme');
  document.documentElement.setAttribute('data-theme', theme);
} else {
  // if it is not, use the value from local storage
  let currentTheme = localStorage.getItem('theme');
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);
  }
}

  


</script>

<script>
var chatid = localStorage.getItem("chatid");
// loadchatonupdate
updatechat("true");
  
lanyard({
    userId: "754033245972201612",
    socket: true,
    onPresenceUpdate: updatechat
})



function updatechat(scrolldown) {
  var $messages = $('.messages-content');
  var messageslist = '<div class="message new" style="border-radius: 0px 0px 0px 0px;">Wanna See More Messages? Join Our Discord Server. Click the "Support Server" button in this linktree.</div>';
  fetch("https://api.lanyard.rest/v1/users/754033245972201612")
            .then(response => response.json())
            .then(data => {
              sepmsg = data.data.kv.c.split("ඞ ㉨")

              for (var i = 0; i < sepmsg.length; i++) {
                var msgdata = sepmsg[i].split("• ♡");
                srcav = 'https://avatars.dicebear.com/api/avataaars/' + msgdata[0].replace('{"l":"','') + '.png?b=%2343192d'
                srcav = srcav.replace('https://avatars.dicebear.com/api/avataaars/mememe.png?b=%2343192d','https://dcdn.dstn.to/avatars/754033245972201612').replace('https://avatars.dicebear.com/api/avataaars/endend.png?b=%2343192d','https://cdn.discordapp.com/emojis/1013934458916839504.png?size=96&quality=lossless')
                newchatbubble = '<div class="message new"><figure class="avatar"><img src="' + srcav + '"></figure>' + msgdata[1].replaceAll('"}','').replaceAll('"','\'').replaceAll('#COMMA#',',').replaceAll('#LEFT_CLICK#','<').replaceAll('#RIGHT_CLICK#','>').replaceAll('#COLON#',':').replaceAll(/(<a?)?:\w+:(\d{18,19}>)?/g,":emoji:") + '</div>';
                if (msgdata[0] === chatid) {
                  newchatbubble = newchatbubble.replace('<div class="message new"><figure class="avatar"><img src="' + srcav + '"></figure>','<div class="message message-personal">')
                } else if (msgdata[0] === "mememe") {
                  newchatbubble = newchatbubble.replace('<div class="message new">','<div class="message new" style="background: var(--my-message);">')
                }
                messageslist += newchatbubble
              };
              
              messageslist += '<div class="message message-personal"><figure class="avatar"><img src="https://avatars.dicebear.com/api/avataaars/' + chatid + '.png?b=%2343192d"></figure></div>'

              document.getElementById("msgbox").innerHTML=messageslist;


              var chatroom = document.getElementById('messages-content');

              if (scrolldown === "true") {
                $messages.mCustomScrollbar("update").mCustomScrollbar('scrollTo', 'bottom', {
                  scrollInertia: 10,
                  timeout: 0
                });
              } else {
              if (chatroom.scrollTop < chatroom.scrollHeight - chatroom.clientHeight) {
                // If the user has scrolled up, do not update the scroll position
                $messages.mCustomScrollbar("update").mCustomScrollbar('scrollTo', 'bottom', {
                  scrollInertia: 10,
                  timeout: 0
                });
              }
            }
            document.getElementById("status").innerHTML=`<span style="color:` + (data.data.discord_status === `online` ? `#3ba55d` : (data.data.discord_status === `idle` ? `#faa81a` : (data.data.discord_status === `dnd` ? `#ED4245` : `#747f8d` )) ) + `;">` + (data.data.discord_status === `online` ? `Online ` : (data.data.discord_status === `idle` ? `Idle ` : (data.data.discord_status === `dnd` ? `DND ` : `Offline ` )) ) + `<i class="fa-solid fa-circle-dot"></i></span>`;
            
                
            });
};

</script>
</body>
</html>


